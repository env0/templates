version: 1

deploy:
  steps:
    setupVariables:
      after:
        - curl -sL https://releases.hashicorp.com/vault/1.11.1/vault_1.11.1_linux_amd64.zip -o vault1.zip
        - unzip -o vault1.zip
        - ./vault --version        
        - ./vault write auth/jwt/login role="${ROLE_NAME}" jwt="${ENV0_OIDC_TOKEN}"
        - ./vault secrets enable -path=secret/ kv
        - ./vault kv put -mount=secret creds passcode=my-long-passcode
        - ./vault kv get -mount=secret creds
